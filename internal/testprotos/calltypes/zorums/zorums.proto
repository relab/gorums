// Copy of dev/zorums.proto

edition = "2023";

package gorums.testprotos.calltypes.zorums;
option go_package = "github.com/relab/gorums/internal/testprotos/calltypes/zorums";

option features.field_presence = IMPLICIT;

import "gorums.proto";
import "google/protobuf/empty.proto";

message Request {
    string Value = 1;
}
message Response {
    int64 Result = 1;
}

// ZorumsService is not meant to be implemented.
// The zorums generated code is placed alongside Gorums static code files
// (without the zorums prefix) because they depend on the generated code.
// The generated code must pass compilation, but no further tests are performed.
// Other tests are provided to test the actual generated code.
// The RPCs in this service aims to test various uses of Gorums's
// options and call types, including imported message types and
// multiple RPCs reusing the same input and output types.
service ZorumsService {
    // GRPCCall plain gRPC call; testing that Gorums can ignore these, but that
    // they are added to the _grpc.pb.go generated file.
    rpc GRPCCall(Request) returns (Response) {}

    // ---------------------------------------------------------------
    // QuorumCall variants
    // ---------------------------------------------------------------

    // QuorumCall plain.
    rpc QuorumCall(Request) returns (Response) {
        option (gorums.quorumcall) = true;
    }
    // QuorumCallEmpty for testing imported message type.
    rpc QuorumCallEmpty(google.protobuf.Empty) returns (Response) {
        option (gorums.quorumcall) = true;
    }
    // QuorumCallEmpty2 for testing imported message type.
    rpc QuorumCallEmpty2(Request) returns (google.protobuf.Empty) {
        option (gorums.quorumcall) = true;
    }

    // ------------------------------------------------------------------
    // Multicast variants
    // ------------------------------------------------------------------

    // Multicast plain. Response type is not needed here.
    rpc Multicast(Request) returns (Response) {
        option (gorums.multicast) = true;
    }
    // Multicast2 is testing whether multiple streams work.
    rpc Multicast2(Request) returns (Response) {
        option (gorums.multicast) = true;
    }
    // Multicast3 is testing imported message type.
    rpc Multicast3(Request) returns (google.protobuf.Empty) {
        option (gorums.multicast) = true;
    }
    // Multicast4 is testing imported message type.
    rpc Multicast4(google.protobuf.Empty) returns (google.protobuf.Empty) {
        option (gorums.multicast) = true;
    }

    // ---------------------------------------------------------------
    // Streaming quorum call variants
    // ---------------------------------------------------------------

    // QuorumCallStream plain.
    rpc QuorumCallStream(Request) returns (stream Response) {
        option (gorums.quorumcall) = true;
    }
    // QuorumCallStreamEmpty for testing imported message type.
    rpc QuorumCallStreamEmpty(Request) returns (stream google.protobuf.Empty) {
        option (gorums.quorumcall) = true;
    }
    // QuorumCallStreamEmpty2 for testing imported message type; with same return
    // type as QuorumCallStream: Response.
    rpc QuorumCallStreamEmpty2(google.protobuf.Empty) returns (stream Response) {
        option (gorums.quorumcall) = true;
    }

    // ---------------------------------------------------------------
    // Unicast
    // ---------------------------------------------------------------

    rpc Unicast(Request) returns (Response) {
        option (gorums.unicast) = true;
    }

    rpc Unicast2(Request) returns (google.protobuf.Empty) {
        option (gorums.unicast) = true;
    }
}
